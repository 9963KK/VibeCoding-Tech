---
name: JVibe:keepgo
description: 自动继续推进项目任务，基于当前文档进度
---

# /JVibe:keepgo - 自动推进下一步

根据 JVibe 开发流程和当前项目状态，**智能识别并执行下一步任务**。

## 核心原则

**只做事，少废话。** 执行完毕后只输出：
1. 本轮执行了什么
2. 下一步建议指令

---

## 状态检测与流程决策

### 检测顺序（按优先级）

```
1. 检查 docs/core/ 目录是否存在
2. 检查 .jvibe-state.json 状态文件
3. 检查项目文档中的模块定义
4. 检查功能清单中的功能条目
5. 检查功能的 TODO 进度
```

### 状态-动作映射表

| 状态 | 判断条件 | 执行动作 | 建议指令 |
|------|----------|----------|----------|
| **未初始化** | `docs/core/` 不存在 | 不执行，仅提示 | `/JVibe:init` |
| **刚初始化** | `.jvibe-state.json` 的 `firstSessionAfterInit=true` | 标记为 false，提示添加功能 | `"添加 XXX 功能"` |
| **有模块无功能** | 项目文档有模块定义，功能清单无 F-XXX 条目 | 不执行，提示从项目文档添加功能 | `"添加 XXX 功能"` |
| **有功能待开始** | 功能清单有 ❌，无 🚧 | 开始第一个 ❌ 功能 | `/JVibe:keepgo` |
| **有功能开发中** | 功能清单有 🚧 | 继续该功能下一个 `[ ]` TODO | `/JVibe:keepgo` |
| **功能即将完成** | 🚧 功能所有 TODO 已 `[x]` | 标记功能为 ✅ | `/JVibe:keepgo` |
| **全部完成** | 所有功能 ✅ | 不执行，提示项目完成 | `"添加 XXX 功能"` |

---

## 执行流程详解

### 场景 1：未初始化

```
检测：docs/core/ 目录不存在
动作：不执行任何操作
输出：提示先运行 /JVibe:init
```

### 场景 2：刚初始化完成

```
检测：.jvibe-state.json 存在且 firstSessionAfterInit=true
动作：
  1. 更新 firstSessionAfterInit 为 false
  2. 读取项目文档中的模块清单
输出：提示从哪个模块开始添加功能
```

### 场景 3：有模块但功能清单为空

```
检测：项目文档有模块定义，功能清单无 F-XXX 条目（只有模板示例）
动作：不执行
输出：
  - 列出可添加功能的模块（从项目文档读取）
  - 建议："添加 [模块名] 的 XXX 功能"
```

### 场景 4：有 ❌ 未开始功能（无 🚧）

```
检测：功能清单有 ❌ 状态功能，无 🚧 状态功能
动作：
  1. 选择第一个 ❌ 功能
  2. 创建功能骨架代码
  3. 将状态改为 🚧
  4. 开始执行第一个 TODO
输出：开始了哪个功能
```

### 场景 5：有 🚧 开发中功能

```
检测：功能清单有 🚧 状态功能
动作：
  1. 找到该功能的 TODO 列表
  2. 执行第一个未完成 [ ] 的 TODO
  3. 完成后将 [ ] 改为 [x]
输出：完成了哪个 TODO
```

### 场景 6：🚧 功能的所有 TODO 已完成

```
检测：🚧 功能的所有 TODO 都是 [x]
动作：
  1. 将功能状态 🚧 改为 ✅
  2. 如果有下一个 ❌ 功能，开始它
输出：功能完成，开始下一个或提示全部完成
```

### 场景 7：所有功能已完成

```
检测：功能清单中所有功能都是 ✅
动作：不执行
输出：项目所有功能已完成，建议添加新功能
```

---

## 输出格式（严格遵守）

```
========================================
  /keepgo 执行完成
========================================

当前状态：{状态名称}

本轮任务：
  {简述执行的内容，1-2句话}

执行结果：
  {关键改动，最多3行}

----------------------------------------
下一步：
  - {建议指令1}
  - {建议指令2，可选}
========================================
```

---

## 严禁输出

- ❌ 文档特点分析
- ❌ 项目架构说明
- ❌ 功能清单完整内容
- ❌ 代码详细解释
- ❌ "总结报告" / "工作总结"
- ❌ Git 提交记录列表
- ❌ 模块功能列表
- ❌ 技术栈说明

---

## 示例输出

### 示例 1：未初始化

```
========================================
  /keepgo 执行完成
========================================

当前状态：未初始化

本轮任务：
  检测项目状态

执行结果：
  ⚠️ 项目尚未初始化 JVibe 文档体系

----------------------------------------
下一步：
  - 初始化项目：/JVibe:init
========================================
```

### 示例 2：刚初始化完成

```
========================================
  /keepgo 执行完成
========================================

当前状态：刚初始化

本轮任务：
  更新初始化状态标记

执行结果：
  ✅ firstSessionAfterInit → false
  📦 检测到 3 个模块：AuthModule, UserModule, ChatModule

----------------------------------------
下一步：
  - 添加功能："添加 AuthModule 的用户注册功能"
  - 查看状态：/JVibe:status
========================================
```

### 示例 3：有模块无功能

```
========================================
  /keepgo 执行完成
========================================

当前状态：有模块无功能

本轮任务：
  检测项目状态

执行结果：
  📦 项目有 3 个模块，功能清单为空
  💡 建议从核心模块 AuthModule 开始

----------------------------------------
下一步：
  - 添加功能："添加用户注册功能"
  - 添加功能："添加用户登录功能"
========================================
```

### 示例 4：继续开发中功能

```
========================================
  /keepgo 执行完成
========================================

当前状态：有功能开发中

本轮任务：
  继续 F-018 文件上传功能 - 完成单元测试

执行结果：
  ✅ 创建 file-upload.service.spec.ts
  ✅ 添加 5 个测试用例
  ✅ TODO 进度 7/9

----------------------------------------
下一步：
  - 继续推进：/JVibe:keepgo
  - 查看状态：/JVibe:status
========================================
```

### 示例 5：功能完成

```
========================================
  /keepgo 执行完成
========================================

当前状态：功能即将完成

本轮任务：
  完成 F-018 文件上传功能

执行结果：
  ✅ F-018 所有 TODO 已完成
  ✅ 功能状态 🚧 → ✅
  📋 下一个功能：F-019 消息搜索

----------------------------------------
下一步：
  - 继续推进：/JVibe:keepgo
  - 查看状态：/JVibe:status
========================================
```

### 示例 6：项目完成

```
========================================
  /keepgo 执行完成
========================================

当前状态：全部完成

本轮任务：
  检查项目状态

执行结果：
  🎉 所有功能已完成 (20/20)
  无待办任务

----------------------------------------
下一步：
  - 添加新功能："添加 XXX 功能"
  - 查看状态：/JVibe:status
========================================
```

---

## 注意事项

1. **自动 commit**：每次执行完成后自动提交改动
2. **幂等性**：多次执行不会重复操作已完成的任务
3. **断点续传**：从上次中断的地方继续
4. **错误处理**：遇到错误时输出原因，建议修复方式
5. **状态同步**：每次执行前都重新读取文档状态，确保准确
